import pymongo
import csv

# Conéctate a tu clúster de MongoDB
client = pymongo.MongoClient("mongodb+srv://POE:Manu7190@cluster0.avhhgxe.mongodb.net/?retryWrites=true&w=majority")

# Selecciona la base de datos que deseas utilizar
db = client["Historico"]

# Selecciona la colección de la que deseas exportar los datos
collection = db["Datos"]

# Campos a exportar
fields = ["fecha", "nubosidad", "temperatura", "viento", "humedad", "presion"]

# Nombre del archivo CSV de salida
csv_file = "datos_exportados.csv"

# Abrir el archivo CSV en modo escritura
with open(csv_file, mode='w', newline='', encoding='utf-8') as file:
    writer = csv.DictWriter(file, fieldnames=fields)
    
    # Escribir el encabezado del archivo CSV
    writer.writeheader()
    
    # Iterar sobre los documentos en la colección y escribirlos en el archivo CSV
    for document in collection.find():
        writer.writerow({field: document[field] for field in fields})

print("Exportación completada. Los datos han sido guardados en", csv_file)
